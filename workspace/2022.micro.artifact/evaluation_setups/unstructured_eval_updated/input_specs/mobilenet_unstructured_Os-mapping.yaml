mapping:  

#
# DRAM
#
- target: DRAM
  type: temporal
  permutation: KNM
  factors: K=1 N=16 M=98 # Adjusted factors K=1*128*1*1=128, N=16*1*1*2*8=256, M=98*1*1*4*8=3136

#
# GLB
#

- target: GLB
  type: temporal
  factors: K=1 N=1 M=1 
  permutation: KNM

- target: GLB
  type: bypass
  bypass: [ Outputs ] 
  keep: [ Inputs, Weights ] 

#
# Buffer
#

- target: Buffer
  type: temporal
  factors: K=128 N=1 M=1 # Adjusted factors
  permutation: NMK

- target: Buffer
  type: bypass
  keep: [ Outputs ] 
  bypass: [ Inputs, Weights ] 


#
# LineBuffer
#

- target: LineBuffer
  type: bypass
  keep: [ Inputs, Weights ] 
  bypass: [  Outputs ] 

- target: LineBuffer
  type: temporal
  factors: K=1 N=2 M=4 # Adjusted factors (same as ResNet)
  permutation: NMK

- target: LineBuffer
  type: spatial
  no_link_transfer: [ Inputs, Weights, Outputs]
  factors: K=1 N=8 M=8 # Adjusted factors (same as ResNet)
  permutation: NKM
  split: 1 